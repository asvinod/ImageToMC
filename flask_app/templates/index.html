<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Image to Minecraft World</title>
  <link href="https://fonts.googleapis.com/css2?family=Pixelify+Sans:wght@400&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #61371F;
      font-family: 'Pixelify Sans', sans-serif;
    }

    .header {
      background: #8FCA5C;
      padding: 20px 0;
      text-align: center;
      border-bottom: 2px solid black;
    }

    .header-title {
      font-size: 48px;
      color: black;
      margin-bottom: 10px;
    }

    .menu-bar {
      display: flex;
      justify-content: center;
      gap: 40px;
    }

    .menu-item {
      color: black;
      font-size: 24px;
      text-decoration: none;
      padding: 8px 16px;
      cursor: pointer;
      border: 2px solid transparent;
    }

    .menu-item:hover {
      background: #70B237;
      border-radius: 6px;
      color: white;
    }

    .drop-label {
      color: white;
      font-size: 32px;
      border: 2px dashed #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: background 0.2s;
    }
    .drop-label span {
      text-align: center;
    }
    .upload-box {
      width: 725px;
      height: 250px;
      background: #C28340;
      margin: 30px auto;
      border-radius: 8px;
      overflow: hidden;
    }
    .submit-btn {
      background: #8FCA5C;
      border: none;
      padding: 12px 32px;
      border-radius: 8px;
      font-size: 24px;
      cursor: pointer;
      margin: 20px auto;
      display: block;
      font-family: 'Pixelify Sans', sans-serif;
    }
    .submit-btn:hover {
      background: #70B237;
    }
    .result-btn {
      background: #35701a;
      color: white;
      font-size: 22px;
      padding: 14px 36px;
      border-radius: 8px;
      text-decoration: none;
      display: inline-block;
      margin: 20px auto;
      font-family: 'Pixelify Sans', sans-serif;
    }
    .result-btn:hover {
      background: #285415;
    }

    #howtoModal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0,0,0,0.5);
    }
    #howtoModal .modal-content {
      background: url('/static/grassblock.jpg') center/cover no-repeat;
      margin: 10% auto;
      width: 350px;
      height: 350px;
      border-radius: 16px;
      position: relative;
      box-shadow: 0 4px 24px rgba(0,0,0,0.3);
    }
    #howtoModal .inner-box {
      background: rgba(255,255,255,0.85);
      border-radius: 12px;
      position: absolute;
      top: 25px;
      left: 25px;
      right: 25px;
      bottom: 25px;
      padding: 20px;
      overflow-y: auto;
      box-sizing: border-box;
    }
    #howtoModal .close {
      position: absolute;
      top: 10px;
      right: 16px;
      cursor: pointer;
      font-size: 20px;
      color: #333;
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="header-title">ImageToMC</div>
    <div class="menu-bar">
      <div class="menu-item" onclick="document.getElementById('howtoModal').style.display='block'">How To Use</div>
      <a href="{{ url_for('get_examples') }}" target="_blank" class="menu-item">Examples</a>
      <a href="https://github.com/asvinod/ImageToMC" target="_blank" class="menu-item">How I Made This</a>
    </div>
  </div>

  <form method="POST" enctype="multipart/form-data">
    {{ form.hidden_tag() }}
    <label for="photo-input" id="image-drop-area" class="upload-box drop-label">
      <span id="image-drop-text">Drop Image here<br/>or click to select</span>
      {{ form.photo(class_='file-input', id='photo-input', style='display:none') }}
      <span id="image-file-name" style="font-size: 20px; color: #fff; margin-top: 10px;"></span>
    </label>
    <label for="world-input" id="world-drop-area" class="upload-box drop-label">
      <span id="world-drop-text">Drop World Zip File<br/>or click to select</span>
      {{ form.world(class_='file-input', id='world-input', style='display:none') }}
      <span id="world-file-name" style="font-size: 20px; color: #fff; margin-top: 10px;"></span>
    </label>
    {{ form.submit(class_='submit-btn') }}
  </form>

  {% if modified_world_url %}
  <a href="{{ modified_world_url }}" class="result-btn">Download Modified World</a>
  {% endif %}

  <div id="howtoModal">
    <div class="modal-content">
      <span class="close" onclick="document.getElementById('howtoModal').style.display='none'">&times;</span>
      <div class="inner-box">
        <ol style="font-family: 'Courier', monospace;">
          <li>If you are creating your own world, select that world, and click "Edit"</li>
          <li>Click "Open World Folder"</li>
          <li>Compress your world</li>
          <li>Drag image on top box</li>
          <li>Drag zip file on bottom box</li>
          <li>Download ZIP file, place into World Folder</li>
          <li>Unzip, and reload Select World (click Back and "Single Player" if you need to)</li>
        </ol>
      </div>
    </div>
  </div>

  <script>
    function setupDropArea(dropAreaId, inputId, fileNameId, dropTextId) {
      const dropArea = document.getElementById(dropAreaId);
      const fileInput = document.getElementById(inputId);
      const fileName = document.getElementById(fileNameId);

      fileInput.addEventListener('change', function() {
        fileName.textContent = fileInput.files.length > 0 ? fileInput.files[0].name : '';
      });

      dropArea.addEventListener('dragover', function(e) {
        e.preventDefault();
        dropArea.style.background = '#b88a3a';
      });
      dropArea.addEventListener('dragleave', function(e) {
        e.preventDefault();
        dropArea.style.background = '#C28340';
      });
      dropArea.addEventListener('drop', function(e) {
        e.preventDefault();
        dropArea.style.background = '#C28340';
        if (e.dataTransfer.files.length > 0) {
          fileInput.files = e.dataTransfer.files;
          fileInput.dispatchEvent(new Event('change'));
        }
      });
    }
    setupDropArea('image-drop-area', 'photo-input', 'image-file-name', 'image-drop-text');
    setupDropArea('world-drop-area', 'world-input', 'world-file-name', 'world-drop-text');
  </script>
</body>
</html>
